<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aviation Maintenance Work Order</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="loader" class="loader-overlay">
        <div class="spinner"></div>
    </div>

    <header class="app-header">
        <div class="container">
            <div class="header-content">
                <h1 id="wo-title">Loading WO...</h1>
                <div class="badge-row">
                    <span id="header-reg" class="badge">--</span>
                    <span id="header-customer" class="badge secondary">--</span>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <section id="wo-info" class="wo-info-panel">
            <div class="info-grid">
                <div class="info-item">
                    <label>Part Description</label>
                    <p id="info-desc">--</p>
                </div>
                <div class="info-item">
                    <label>P/N</label>
                    <p id="info-pn">--</p>
                </div>
                <div class="info-item">
                    <label>S/N</label>
                    <p id="info-sn">--</p>
                </div>
            </div>
        </section>

        <section id="findings-container" class="findings-list">
            <!-- Cards injected by JS -->
        </section>
    </main>

    <div id="image-modal" class="modal">
        <div class="modal-content full-image-content">
            <span class="close-modal">&times;</span>
            <img id="modal-img-large" src="" alt="Finding Image">
        </div>
    </div>

    <div id="conflict-modal" class="modal">
        <div class="modal-content">
            <h3>Active Session Conflict</h3>
            <p>The following personnel are already working on this finding:</p>
            <ul id="active-mechanics-list"></ul>
            <p>Do you wish to join this task?</p>
            <div class="modal-actions">
                <button id="confirm-join" class="btn btn-primary">Join Task</button>
                <button class="btn btn-secondary close-modal-btn">Cancel</button>
            </div>
        </div>
    </div>

    <div id="stop-modal" class="modal">
        <div class="modal-content">
            <h3>Stop Man-hour</h3>
            <p>Select your Employee ID to stop:</p>
            <div id="stop-user-options" class="button-stack"></div>
            <div class="modal-actions">
                <button class="btn btn-secondary close-modal-btn">Cancel</button>
            </div>
        </div>
    </div>

    <div id="final-modal" class="modal">
        <div class="modal-content">
            <h3>Finalize Finding</h3>
            <p>All active sessions have ended. Select final status:</p>
            <div class="form-group">
                <label>Finding Status</label>
                <select id="final-status-select">
                    <option value="OPEN">ON HOLD (Re-Open)</option>
                    <option value="CLOSED">CLOSED (Complete)</option>
                </select>
            </div>
            <div id="evidence-upload-section" class="form-group hidden">
                <label>Evidence Image (Required for CLOSED)</label>
                <input type="file" id="evidence-file" accept="image/*" capture="environment">
            </div>
            <div class="modal-actions">
                <button id="submit-finalize" class="btn btn-success">Submit</button>
                <button class="btn btn-secondary close-modal-btn">Cancel</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
